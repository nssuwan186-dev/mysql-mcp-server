# golangci-lint configuration
# https://golangci-lint.run/usage/configuration/

run:
  timeout: 5m
  tests: true

linters:
  # Use default linters plus a few safe additions
  enable:
    - bodyclose      # Checks whether HTTP response body is closed
    - errorlint      # Find code that will cause issues with error wrapping
    - gocritic       # Opinionated linter for Go
    - gosec          # Inspects source code for security problems
    - misspell       # Finds commonly misspelled English words
    - noctx          # Finds HTTP requests without context.Context
    - sqlclosecheck  # Checks that sql.Rows and sql.Stmt are closed
    - unconvert      # Remove unnecessary type conversions

linters-settings:
  errcheck:
    check-type-assertions: true
    exclude-functions:
      - (io.Closer).Close
      - (*os.File).Close
      - (net/http.ResponseWriter).Write

  gocritic:
    enabled-tags:
      - diagnostic
    disabled-checks:
      - hugeParam        # MCP interface requires value params
      - exitAfterDefer   # Acceptable for fatal startup errors

  gosec:
    excludes:
      - G104  # Allow unhandled errors in some cases

  misspell:
    locale: US

issues:
  exclude-rules:
    # Exclude some linters from running on tests files
    - path: _test\.go
      linters:
        - errcheck
        - gocritic
        - gosec

  max-issues-per-linter: 50
  max-same-issues: 5
